CREATE SCHEMA IF NOT EXISTS tours;

CREATE TABLE IF NOT EXISTS tours."Quizzes" (
    "Id" BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "AuthorId" BIGINT NOT NULL,
    "Title" TEXT NOT NULL,
    "Description" TEXT NULL,
    "CreatedAt" TIMESTAMPTZ NOT NULL,
    "UpdatedAt" TIMESTAMPTZ NULL
);

CREATE TABLE IF NOT EXISTS tours."QuizQuestions" (
    "Id" BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "QuizId" BIGINT NOT NULL,
    "Text" TEXT NOT NULL,
    "AllowsMultipleAnswers" BOOLEAN NOT NULL DEFAULT FALSE,
    CONSTRAINT "FK_QuizQuestions_Quizzes"
        FOREIGN KEY ("QuizId") REFERENCES tours."Quizzes"("Id") ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS tours."QuizAnswerOptions" (
    "Id" BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "QuestionId" BIGINT NOT NULL,
    "Text" TEXT NOT NULL,
    "IsCorrect" BOOLEAN NOT NULL,
    "Feedback" TEXT NOT NULL DEFAULT '',
    CONSTRAINT "FK_QuizAnswerOptions_QuizQuestions"
        FOREIGN KEY ("QuestionId") REFERENCES tours."QuizQuestions"("Id") ON DELETE CASCADE
);
